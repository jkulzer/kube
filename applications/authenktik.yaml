apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: metallb
  namespace: argocd
spec:
  destination:
    namespace: metallb-system
    server: https://kubernetes.default.svc
  project: default
  source:
    chart: metallb
    targetRevision: 0.12.1
    repoURL: https://metallb.github.io/metallb
    helm:
      releaseName: metallb
      values: |
        authentik:
          annotations:
            vault.hashicorp.com/agent-inject: 'true'
            vault.hashicorp.com/role: 'internal-app'
            vault.hashicorp.com/agent-inject-secret-database-config.txt: 'internal/data/database/config'
          secret_key: ""
          # This sends anonymous usage-data, stack traces on errors and
          # performance data to sentry.beryju.org, and is fully opt-in
          error_reporting:
            enabled: true
          postgresql:
            password: "ThisIsNotASecurePassword"

        ingress:
          enabled: true
          hosts:
          - host: authentik.domain.tld
            paths:
            - path: "/"
              pathType: Prefix

        postgresql:
          enabled: true
          postgresqlPassword: "ThisIsNotASecurePassword"
        redis:
          enabled: true

